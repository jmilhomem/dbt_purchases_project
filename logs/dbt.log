2020-06-11 02:04:54.834494 (MainThread): Running with dbt=0.16.1
2020-06-11 02:04:54.902216 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/home/carol/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-06-11 02:04:54.902531 (MainThread): Tracking: tracking
2020-06-11 02:04:54.910239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc03ed3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc01574350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc01574cd0>]}
2020-06-11 02:04:54.935564 (MainThread): Partial parsing not enabled
2020-06-11 02:04:54.938800 (MainThread): Parsing macros/core.sql
2020-06-11 02:04:54.944233 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-06-11 02:04:54.947148 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-06-11 02:04:54.948522 (MainThread): Parsing macros/etc/datetime.sql
2020-06-11 02:04:54.960613 (MainThread): Parsing macros/etc/query.sql
2020-06-11 02:04:54.962163 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-06-11 02:04:54.964554 (MainThread): Parsing macros/etc/is_incremental.sql
2020-06-11 02:04:54.966732 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-06-11 02:04:54.968817 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-06-11 02:04:54.970796 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-06-11 02:04:54.972858 (MainThread): Parsing macros/schema_tests/unique.sql
2020-06-11 02:04:54.974647 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-06-11 02:04:54.977550 (MainThread): Parsing macros/adapters/common.sql
2020-06-11 02:04:55.030305 (MainThread): Parsing macros/materializations/helpers.sql
2020-06-11 02:04:55.039800 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-06-11 02:04:55.064089 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-06-11 02:04:55.069920 (MainThread): Parsing macros/materializations/view/view.sql
2020-06-11 02:04:55.076806 (MainThread): Parsing macros/materializations/common/merge.sql
2020-06-11 02:04:55.090114 (MainThread): Parsing macros/materializations/table/table.sql
2020-06-11 02:04:55.097748 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-06-11 02:04:55.116563 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-06-11 02:04:55.154779 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-06-11 02:04:55.156905 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-06-11 02:04:55.164102 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-06-11 02:04:55.166948 (MainThread): Parsing macros/relations.sql
2020-06-11 02:04:55.168581 (MainThread): Parsing macros/catalog.sql
2020-06-11 02:04:55.171218 (MainThread): Parsing macros/adapters.sql
2020-06-11 02:04:55.189019 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-06-11 02:04:55.210405 (MainThread): Partial parsing not enabled
2020-06-11 02:04:55.241213 (MainThread): Acquiring new postgres connection "model.purchases_project.stg_transactions_offers".
2020-06-11 02:04:55.241377 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.261248 (MainThread): Acquiring new postgres connection "model.purchases_project.stg_offers".
2020-06-11 02:04:55.261409 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.267846 (MainThread): Acquiring new postgres connection "model.purchases_project.stg_transactions".
2020-06-11 02:04:55.268009 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.275356 (MainThread): Acquiring new postgres connection "model.purchases_project.analytics_transactions".
2020-06-11 02:04:55.275512 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.281670 (MainThread): Acquiring new postgres connection "model.purchases_project.analytics_offers".
2020-06-11 02:04:55.281821 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.288491 (MainThread): Acquiring new postgres connection "model.purchases_project.analytics_transactions_yearmonth".
2020-06-11 02:04:55.288651 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.329388 (MainThread): Acquiring new postgres connection "test.purchases_project.not_null_stg_transactions_id".
2020-06-11 02:04:55.329554 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.364284 (MainThread): Acquiring new postgres connection "test.purchases_project.unique_analytics_offers_concat_category_company_brand_".
2020-06-11 02:04:55.364544 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.376646 (MainThread): Acquiring new postgres connection "test.purchases_project.not_null_analytics_offers_concat_category_company_brand_".
2020-06-11 02:04:55.376813 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.385058 (MainThread): Acquiring new postgres connection "test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_".
2020-06-11 02:04:55.385227 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.554004 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 2 seed files, 2 sources
2020-06-11 02:04:55.560048 (MainThread): 
2020-06-11 02:04:55.560232 (MainThread): 23:04:55 | Concurrency: 1 threads (target='dev')
2020-06-11 02:04:55.560332 (MainThread): 23:04:55 | 
2020-06-11 02:04:55.562378 (Thread-1): Began running node model.purchases_project.stg_offers
2020-06-11 02:04:55.563107 (Thread-1): Acquiring new postgres connection "model.purchases_project.stg_offers".
2020-06-11 02:04:55.563314 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.563523 (Thread-1): Compiling model.purchases_project.stg_offers
2020-06-11 02:04:55.585911 (Thread-1): Writing injected SQL for node "model.purchases_project.stg_offers"
2020-06-11 02:04:55.586858 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.587368 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.587841 (Thread-1): Finished running node model.purchases_project.stg_offers
2020-06-11 02:04:55.587971 (Thread-1): Began running node model.purchases_project.stg_transactions
2020-06-11 02:04:55.588354 (Thread-1): Acquiring new postgres connection "model.purchases_project.stg_transactions".
2020-06-11 02:04:55.588538 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.588656 (Thread-1): Compiling model.purchases_project.stg_transactions
2020-06-11 02:04:55.598339 (Thread-1): Writing injected SQL for node "model.purchases_project.stg_transactions"
2020-06-11 02:04:55.598742 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.599022 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.599561 (Thread-1): Finished running node model.purchases_project.stg_transactions
2020-06-11 02:04:55.599730 (Thread-1): Began running node seed.purchases_project.offers
2020-06-11 02:04:55.600047 (Thread-1): Acquiring new postgres connection "seed.purchases_project.offers".
2020-06-11 02:04:55.600370 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.600631 (Thread-1): Compiling seed.purchases_project.offers
2020-06-11 02:04:55.612308 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.612594 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.612972 (Thread-1): Finished running node seed.purchases_project.offers
2020-06-11 02:04:55.613112 (Thread-1): Began running node seed.purchases_project.transactions
2020-06-11 02:04:55.613458 (Thread-1): Acquiring new postgres connection "seed.purchases_project.transactions".
2020-06-11 02:04:55.613569 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.613674 (Thread-1): Compiling seed.purchases_project.transactions
2020-06-11 02:04:55.618880 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.619180 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.619588 (Thread-1): Finished running node seed.purchases_project.transactions
2020-06-11 02:04:55.619714 (Thread-1): Began running node model.purchases_project.analytics_offers
2020-06-11 02:04:55.620055 (Thread-1): Acquiring new postgres connection "model.purchases_project.analytics_offers".
2020-06-11 02:04:55.620139 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.620218 (Thread-1): Compiling model.purchases_project.analytics_offers
2020-06-11 02:04:55.626734 (Thread-1): Writing injected SQL for node "model.purchases_project.analytics_offers"
2020-06-11 02:04:55.627244 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.627500 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.627921 (Thread-1): Finished running node model.purchases_project.analytics_offers
2020-06-11 02:04:55.628050 (Thread-1): Began running node model.purchases_project.stg_transactions_offers
2020-06-11 02:04:55.628411 (Thread-1): Acquiring new postgres connection "model.purchases_project.stg_transactions_offers".
2020-06-11 02:04:55.628652 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.628742 (Thread-1): Compiling model.purchases_project.stg_transactions_offers
2020-06-11 02:04:55.636923 (Thread-1): Writing injected SQL for node "model.purchases_project.stg_transactions_offers"
2020-06-11 02:04:55.637297 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.637536 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.637993 (Thread-1): Finished running node model.purchases_project.stg_transactions_offers
2020-06-11 02:04:55.638117 (Thread-1): Began running node test.purchases_project.not_null_stg_transactions_id
2020-06-11 02:04:55.638495 (Thread-1): Acquiring new postgres connection "test.purchases_project.not_null_stg_transactions_id".
2020-06-11 02:04:55.638725 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.638811 (Thread-1): Compiling test.purchases_project.not_null_stg_transactions_id
2020-06-11 02:04:55.654533 (Thread-1): Writing injected SQL for node "test.purchases_project.not_null_stg_transactions_id"
2020-06-11 02:04:55.655130 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.655609 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.656122 (Thread-1): Finished running node test.purchases_project.not_null_stg_transactions_id
2020-06-11 02:04:55.656263 (Thread-1): Began running node test.purchases_project.not_null_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.656663 (Thread-1): Acquiring new postgres connection "test.purchases_project.not_null_analytics_offers_concat_category_company_brand_".
2020-06-11 02:04:55.656755 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.656845 (Thread-1): Compiling test.purchases_project.not_null_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.666074 (Thread-1): Writing injected SQL for node "test.purchases_project.not_null_analytics_offers_concat_category_company_brand_"
2020-06-11 02:04:55.666505 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.666758 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.667160 (Thread-1): Finished running node test.purchases_project.not_null_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.667295 (Thread-1): Began running node test.purchases_project.unique_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.667531 (Thread-1): Acquiring new postgres connection "test.purchases_project.unique_analytics_offers_concat_category_company_brand_".
2020-06-11 02:04:55.667754 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.667840 (Thread-1): Compiling test.purchases_project.unique_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.675989 (Thread-1): Writing injected SQL for node "test.purchases_project.unique_analytics_offers_concat_category_company_brand_"
2020-06-11 02:04:55.676371 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.676603 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.676970 (Thread-1): Finished running node test.purchases_project.unique_analytics_offers_concat_category_company_brand_
2020-06-11 02:04:55.677086 (Thread-1): Began running node model.purchases_project.analytics_transactions
2020-06-11 02:04:55.677419 (Thread-1): Acquiring new postgres connection "model.purchases_project.analytics_transactions".
2020-06-11 02:04:55.677495 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.677568 (Thread-1): Compiling model.purchases_project.analytics_transactions
2020-06-11 02:04:55.684119 (Thread-1): Writing injected SQL for node "model.purchases_project.analytics_transactions"
2020-06-11 02:04:55.684461 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.684686 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.685055 (Thread-1): Finished running node model.purchases_project.analytics_transactions
2020-06-11 02:04:55.685168 (Thread-1): Began running node model.purchases_project.analytics_transactions_yearmonth
2020-06-11 02:04:55.685508 (Thread-1): Acquiring new postgres connection "model.purchases_project.analytics_transactions_yearmonth".
2020-06-11 02:04:55.685739 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.685820 (Thread-1): Compiling model.purchases_project.analytics_transactions_yearmonth
2020-06-11 02:04:55.692394 (Thread-1): Writing injected SQL for node "model.purchases_project.analytics_transactions_yearmonth"
2020-06-11 02:04:55.692759 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.693003 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.693400 (Thread-1): Finished running node model.purchases_project.analytics_transactions_yearmonth
2020-06-11 02:04:55.693523 (Thread-1): Began running node test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_
2020-06-11 02:04:55.693866 (Thread-1): Acquiring new postgres connection "test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_".
2020-06-11 02:04:55.693951 (Thread-1): Opening a new connection, currently in state init
2020-06-11 02:04:55.694032 (Thread-1): Compiling test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_
2020-06-11 02:04:55.702535 (Thread-1): Writing injected SQL for node "test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_"
2020-06-11 02:04:55.702936 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.703191 (Thread-1): finished collecting timing info
2020-06-11 02:04:55.703600 (Thread-1): Finished running node test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_
2020-06-11 02:04:55.766932 (MainThread): Connection 'test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_' was properly closed.
2020-06-11 02:04:55.767285 (MainThread): Connection 'test.purchases_project.not_null_analytics_transactions_concat_id_category_company_brand_' was properly closed.
2020-06-11 02:04:55.808318 (MainThread): 23:04:55 | Done.
2020-06-11 02:04:55.812076 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-06-11 02:04:55.812216 (MainThread): Opening a new connection, currently in state init
2020-06-11 02:04:55.812293 (MainThread): 23:04:55 | Building catalog
2020-06-11 02:04:55.860313 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "postgres.information_schema".
2020-06-11 02:04:55.860657 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-06-11 02:04:55.942308 (ThreadPoolExecutor-0_0): Using postgres connection "postgres.information_schema".
2020-06-11 02:04:55.942469 (ThreadPoolExecutor-0_0): On postgres.information_schema: BEGIN
2020-06-11 02:04:57.653909 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 1.71 seconds
2020-06-11 02:04:57.654394 (ThreadPoolExecutor-0_0): Using postgres connection "postgres.information_schema".
2020-06-11 02:04:57.654700 (ThreadPoolExecutor-0_0): On postgres.information_schema: /* {"app": "dbt", "dbt_version": "0.16.1", "profile_name": "default", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('warehouse'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-06-11 02:04:57.859219 (ThreadPoolExecutor-0_0): SQL status: SELECT 80 in 0.20 seconds
2020-06-11 02:04:57.870719 (ThreadPoolExecutor-0_0): On postgres.information_schema: ROLLBACK
2020-06-11 02:04:58.158427 (MainThread): 23:04:58 | Catalog written to /home/carol/repos/dbt_purchases_project/target/catalog.json
2020-06-11 02:04:58.158810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc012b03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc012b0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc012b0e90>]}
2020-06-11 02:04:58.159026 (MainThread): Flushing usage events
2020-06-11 02:04:59.396834 (MainThread): Connection 'generate_catalog' was properly closed.
2020-06-11 02:04:59.397592 (MainThread): Connection 'postgres.information_schema' was left open.
2020-06-11 02:04:59.397857 (MainThread): On postgres.information_schema: Close
2020-06-11 02:05:07.121771 (MainThread): Running with dbt=0.16.1
2020-06-11 02:05:07.186617 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/home/carol/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-06-11 02:05:07.186919 (MainThread): Tracking: tracking
2020-06-11 02:05:07.193520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c24fcf390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c22672290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c22672690>]}
2020-06-11 02:05:07.195359 (MainThread): Serving docs at 0.0.0.0:8080
2020-06-11 02:05:07.195525 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-06-11 02:05:07.195610 (MainThread): Press Ctrl+C to exit.


2020-06-11 02:10:18.319365 (MainThread): Flushing usage events
2020-06-11 02:10:19.096617 (MainThread): ctrl-c
